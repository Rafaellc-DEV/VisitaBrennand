<!DOCTYPE html>
<html lang="pt" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title th:text="${pageTitle} ?: 'Avisos de Funcionamento'">Avisos de Funcionamento</title>

    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet"/>

    <style>
        :root {
          --brand:#294A5D;
          --accent:#A7532C;
          --olive:#556B2F;
          --beige:#F4F1EA;
          --ink:#1A202C;
          --muted:#718096;
          --surface:#FFFFFF;
          --line:#E5E7EB;
          --bg:#F0F5FA;
          --soft:#f9fafb;
        }

        html, body { height: 100%; }
        body {
          font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
          color: var(--ink);
          background-color: var(--bg);
        }

        .app {
          display: grid;
          grid-template-columns: 280px 1fr;
          min-height: 100vh;
        }
        @media (max-width: 991.98px){
          .app{ grid-template-columns: 1fr; }
          .sidebar{ display: none; }
        }


        .sidebar{
          background: linear-gradient(180deg, #ffffff, #fafafa 70%);
          border-right:1px solid var(--line);
          display: flex;
          flex-direction: column;
        }
        .brand{ padding:24px 20px; border-bottom:1px solid var(--line); }
        .brand h1{
          font-size:22px; letter-spacing:.6px; margin:0;
          color:var(--brand); font-weight:800; text-transform:uppercase;
        }
        .menu-section{
          padding:16px 14px 8px; color:var(--muted); font-weight:600;
          text-transform:uppercase; font-size:12px;
        }
        .nav-item + .nav-item{ margin-top:8px; }
        .nav-link{
          display:flex; align-items:center; gap:10px; padding:12px 14px;
          border-radius:12px; color:var(--ink); background:var(--surface);
          border:1px solid var(--line); transition: all .18s ease;
          text-decoration:none; font-weight:500;
        }
        .nav-link:hover{
          transform: translateY(-1px);
          box-shadow:0 6px 14px -8px rgba(0,0,0,.15);
          border-color:#dfe3e8;
        }
        .nav-link .bi{ font-size:18px; color:var(--brand); }
        .nav-link.active{
          border-color: color-mix(in oklab, var(--brand) 28%, white);
          background: color-mix(in oklab, var(--brand) 8%, white);
          box-shadow: inset 0 0 0 1px color-mix(in oklab, var(--brand) 20%, transparent);
          font-weight: 600;
        }
        .sidebar-footer{
          margin-top:auto; padding:16px; border-top:1px solid var(--line);
        }
        .user-card{
          display:flex; gap:12px; align-items:center;
          padding:12px; border:1px solid var(--line);
          border-radius:12px; background:var(--surface);
        }
        .avatar{
          width:36px; height:36px; border-radius:50%;
          display:grid; place-items:center;
          border:1px solid var(--line);
          background: color-mix(in oklab, var(--brand) 12%, white);
          color:var(--brand); font-weight:700;
        }


        main.content {
          flex-grow: 1;
          display: flex;
          flex-direction: column;
        }

        .topbar {
          padding:16px 24px;
          display:flex; align-items:center; justify-content:space-between;
          border-bottom:1px solid var(--line);
          background: rgba(255,255,255,.65);
          backdrop-filter: blur(8px);
          position:sticky; top:0; z-index:10;
        }

        .title {
          margin:0;
          font-size:24px;
          font-weight:700;
          color:var(--brand);
        }

        .content-area {
          display: flex;
          justify-content: center;
          align-items: center;
          flex-direction: column;
          flex-grow: 1;
          padding: 3rem 1rem;
        }

        .content-area h2 {
          font-weight: 800;
          font-size: 2rem;
          color: var(--ink);
          text-align: center;
          margin-bottom: 2rem;
        }

        .form-card {
          background: var(--surface);
          border: 1px solid var(--line);
          border-radius: 18px;
          box-shadow: 0 6px 16px rgba(0,0,0,0.08);
          max-width: 700px;
          width: 100%;
          padding: 2.5rem 2rem;
        }

        .form-label {
          font-weight: 600;
          color: var(--muted);
          margin-bottom: 6px;
          display: block;
        }

        .form-control, .form-select {
          border-radius: 10px;
          border: 1px solid var(--line);
          padding: 12px;
          font-size: 15px;
          color: var(--ink);
          background: var(--surface);
          transition: border-color 0.2s;
        }

        .form-control:focus, .form-select:focus {
          border-color: var(--brand);
          box-shadow: 0 0 0 3px rgba(41,74,93,0.15);
        }

        textarea.form-control {
          resize: none;
          min-height: 100px;
        }

        .btn-confirm {
          display: inline-block;
          width: 100%;
          background: var(--ink);
          color: white;
          font-weight: 600;
          border: none;
          border-radius: 10px;
          padding: 12px;
          font-size: 1rem;
          transition: all 0.2s ease;
          margin-top: 1.5rem;
        }

        .btn-confirm:hover {
          background: #2d3748;
        }

        .form-icon {
          position: relative;
        }
        .form-icon i {
          position: absolute;
          left: 12px;
          top: 50%;
          transform: translateY(-50%);
          color: var(--muted);
          font-size: 18px;
        }
        .form-icon input {
          padding-left: 40px;
        }

        /* Para a mensagem de sucesso */
        .alert-success {
          max-width: 700px;
          width: 100%;
          margin-bottom: 1rem;
        }

    </style>
</head>
<body>
<div class="app">

    <aside class="sidebar d-none d-lg-flex flex-column">
        <div class="brand">
            <h1>VISITA<br/>BRENNAND</h1>
        </div>
        <div class="px-3 pt-3">
            <div class="menu-section">Principal</div>
            <nav class="nav flex-column">
                <div class="nav-item"><a class="nav-link active" th:href="@{/admin/avisos}"><i class="bi bi-bell"></i> Avisos</a></div>
                <div class="nav-item"><a class="nav-link" th:href="@{/admin/horarios}"><i class="bi bi-clock"></i> Horários</a></div>
                <div class="nav-item"><a class="nav-link" th:href="@{/admin/regras}"><i class="bi bi-journal-check"></i> Regras</a></div>
            </nav>

            <div class="menu-section">Gestão</div>
            <nav class="nav flex-column mb-4">
                <div class="nav-item"><a class="nav-link" th:href="@{/admin/feedbacks}"><i class="bi bi-chat-square-heart"></i> Feedbacks</a></div>
                <div class="nav-item"><a class="nav-link" th:href="@{/admin/relatorios}"><i class="bi bi-graph-up"></i> Relatórios</a></div>
            </nav>
        </div>

        <div class="sidebar-footer">
            <div class="user-card mb-2">
                <div class="avatar">A</div>
                <div class="small">
                    <div class="fw-semibold">Administrador</div>
                    <div class="text-muted">@admin</div>
                </div>
            </div>
            <a class="btn btn-outline-secondary w-100" th:href="@{/logout}">
                <i class="bi bi-box-arrow-left me-1"></i> Sair
            </a>
        </div>
    </aside>


    <main class="content">
        <div class="topbar">
            <h2 class="title" th:text="${pageTitle}">Painel administrativo</h2>
            <a class="btn btn-sm btn-outline-secondary" th:href="@{/}">
                <i class="bi bi-house me-1"></i> Ver site
            </a>
        </div>

        <section class="content-area">

            <div th:if="${success}" class="alert alert-success" role="alert" th:text="${success}">
            </div>

            <h2>Avisos de funcionamento</h2>
            <div class="form-card">

                <form method="post" th:action="@{/admin/avisos/salvar}" th:object="${aviso}">
                    <input type="hidden" th:if="${_csrf}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

                    <div class="mb-3 form-icon">
                        <label for="data" class="form-label">Data</label>
                        <i class="bi bi-calendar3"></i>
                        <input type="date" id="data" th:field="*{data}" class="form-control" required>
                    </div>

                    <div class="mb-3">
                        <label for="situacao" class="form-label">Situação</label>
                        <select id="situacao" th:field="*{ativo}" class="form-select" required>
                            <option value="true">Aberto</option>
                            <option value="false">Fechado</option>
                        </select>
                    </div>

                    <div class="mb-3">
                        <label for="aviso" class="form-label">Aviso</label>
                        <textarea id="aviso" th:field="*{texto}" class="form-control" placeholder="Digite aqui..." required></textarea>
                    </div>

                    <button type="submit" class="btn-confirm">Confirmar</button>
                </form>
            </div>
        </section>
    </main>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    //Preenche automaticamente o campo de data com a data atual
    // SÓ SE O CAMPO ESTIVER VAZIO (para não sobrescrever o th:field)
    document.addEventListener('DOMContentLoaded', () => {
      const dataInput = document.getElementById('data');
      if (dataInput.value) return; // Se o Thymeleaf já preencheu, não mexe

      const hoje = new Date();
      const ano = hoje.getFullYear();
      const mes = String(hoje.getMonth() + 1).padStart(2, '0');
      const dia = String(hoje.getDate()).padStart(2, '0');
      dataInput.value = `${ano}-${mes}-${dia}`;
    });
</script>
</body>
</html>