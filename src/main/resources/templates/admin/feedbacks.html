<!DOCTYPE html>
<html th:replace="~{admin/base :: layout('Feedbacks', ~{::section})}" xmlns:th="http://www.thymeleaf.org">
<section>
    <style>
        /* Ajuste de variáveis locais */
        :root{ --olive-feedback: #2e7d32; }

        .wrap { max-width: 980px; margin: 0 auto; width: 100%; }

        .filters-bar {
            position: sticky; top: 74px; z-index: 5;
            background: var(--surface); border: 1px solid var(--line);
            border-radius: 14px; padding: 14px;
            box-shadow: 0 10px 24px -18px rgba(0,0,0,.3); margin-bottom: 18px;
        }
        .filters-bar .title { font-size: 20px; font-weight: 800; margin: 0 0 8px 0; color: var(--brand); }
        .filters-grid { display: grid; grid-template-columns: 1fr 1fr auto; gap: 12px; }
        @media (max-width: 720px){ .filters-grid{ grid-template-columns: 1fr; } }

        .btn-filter {
            height: 42px; display: inline-flex; align-items: center; gap: 8px;
            border-radius: 10px; border: 1px solid var(--line);
            background: color-mix(in oklab, var(--brand) 10%, white);
            color: var(--ink); font-weight: 600; padding: 0 16px;
            transition: all .18s ease;
        }
        .btn-filter:hover { transform: translateY(-1px); box-shadow: 0 10px 18px -16px rgba(0,0,0,.35); }

        .list { display: grid; grid-template-columns: 1fr; gap: 14px; }
        .feedback-card {
            border:1px solid var(--line); border-radius:14px;
            background:linear-gradient(180deg, var(--surface), var(--soft));
            padding:16px 18px; box-shadow:0 14px 28px -22px rgba(0,0,0,.35);
            transition: all .18s ease;
        }
        .feedback-card:hover { transform: translateY(-2px); border-color: #d9dee6; box-shadow:0 18px 36px -26px rgba(0,0,0,.45); }

        .card-head { display:flex; align-items:center; justify-content:space-between; gap: 8px; margin-bottom: 6px; }
        .name { font-size: 16px; font-weight: 700; letter-spacing:.2px; }
        .badge-chip { border-radius: 20px; padding: 6px 10px; font-size: 12px; font-weight: 700; }
        .chip-sug { background:#e9f7ee; color: var(--olive-feedback); border:1px solid #cfead7; }
        .chip-rec { background:#fdecec; color:#c62828; border:1px solid #f7d4d4; }

        .stars { display:flex; align-items:center; gap:2px; margin: 4px 0 8px 0; font-size: 18px; line-height: 1; }
        .star { color:#f6c343; }
        .star-muted { color:#cbd5e1; }
        .comment { margin: 0 0 6px 0; color: var(--ink); font-size: 15px; }
        .date { color: var(--muted); font-size: 12px; }
        .empty { text-align:center; color:var(--muted); margin-top: 36px; }
        .empty i { font-size: 38px; display:block; margin-bottom: 6px; }
    </style>

    <div class="wrap">
        <form method="get" class="filters-bar">
            <h3 class="title"><i class="bi bi-chat-square-heart me-1"></i> Feedbacks Recebidos</h3>

            <div class="filters-grid">
                <div>
                    <label class="form-label">Filtrar por tipo</label>
                    <select class="form-select" name="tipo">
                        <option value="" th:selected="${tipoSelecionado == null}">Todos</option>
                        <option th:value="'Sugestão'" th:selected="${tipoSelecionado == 'Sugestão'}">Sugestão</option>
                        <option th:value="'Reclamação'" th:selected="${tipoSelecionado == 'Reclamação'}">Reclamação</option>
                    </select>
                </div>
                <div>
                    <label class="form-label">Ordenar por</label>
                    <select class="form-select" name="ordenar">
                        <option th:value="'recentes'" th:selected="${ordenacaoSelecionada == 'recentes'}">Mais recentes</option>
                        <option th:value="'estrelas'" th:selected="${ordenacaoSelecionada == 'estrelas'}">Mais bem avaliados</option>
                    </select>
                </div>
                <div class="d-flex align-items-end">
                    <button type="submit" class="btn-filter w-100">
                        <i class="bi bi-funnel"></i> Aplicar filtros
                    </button>
                </div>
            </div>
        </form>

        <div class="list" th:if="${feedbacks != null and feedbacks.size() > 0}">
            <div class="feedback-card" th:each="f : ${feedbacks}">
                <div class="card-head">
                    <div class="name" th:text="${f.nome}">Nome</div>
                    <span class="badge-chip"
                          th:classappend="${f.tipo == 'Reclamação'} ? ' chip-rec' : ' chip-sug'"
                          th:text="${f.tipo}">Tipo</span>
                </div>
                <div class="stars">
                    <span th:each="n : ${#numbers.sequence(1, f.nota)}"><i class="bi bi-star-fill star"></i></span>
                    <span th:if="${f.nota < 5}" th:each="n : ${#numbers.sequence(1, 5 - f.nota)}"><i class="bi bi-star star-muted"></i></span>
                </div>
                <p class="comment" th:text="${f.comentario}">Comentário</p>
                <div class="date" th:text="${#temporals.format(f.criadoEm, 'dd/MM/yyyy HH:mm')}">Data</div>
            </div>
        </div>

        <div class="empty" th:if="${feedbacks == null or feedbacks.size() == 0}">
            <i class="bi bi-inbox"></i> Nenhum feedback encontrado.
        </div>
    </div>
</section>
</html>